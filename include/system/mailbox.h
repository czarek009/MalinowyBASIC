#ifndef _MAILBOX_H
#define _MAILBOX_H

#include "types.h"


#define RPI_FIRMWARE_GET_CLOCK_RATE 0x00030002

enum mailboxTagE {
  MBOX_TAG_END = 0,
  MBOX_TAG_GET_MAX_TEMPERATURE = 0x0003000a,
  MBOX_TAG_GET_TEMPERATURE = 0x00030006,

  MBOX_TAG_FRAMEBUFFER_ALLOCATE =                   0x00040001,
  MBOX_TAG_FRAMEBUFFER_BLANK =                      0x00040002,
  MBOX_TAG_FRAMEBUFFER_GET_PHYSICAL_WIDTH_HEIGHT =  0x00040003,
  MBOX_TAG_FRAMEBUFFER_GET_VIRTUAL_WIDTH_HEIGHT =   0x00040004,
  MBOX_TAG_FRAMEBUFFER_GET_DEPTH =                  0x00040005,
  MBOX_TAG_FRAMEBUFFER_GET_PIXEL_ORDER =            0x00040006,
  MBOX_TAG_FRAMEBUFFER_GET_ALPHA_MODE =             0x00040007,
  MBOX_TAG_FRAMEBUFFER_GET_PITCH =                  0x00040008,
  MBOX_TAG_FRAMEBUFFER_GET_VIRTUAL_OFFSET =         0x00040009,
  MBOX_TAG_FRAMEBUFFER_GET_OVERSCAN =               0x0004000a,
  MBOX_TAG_FRAMEBUFFER_GET_PALETTE =                0x0004000b,
  MBOX_TAG_FRAMEBUFFER_GET_TOUCHBUF =               0x0004000f,
  MBOX_TAG_FRAMEBUFFER_GET_GPIOVIRTBUF =            0x00040010,
  MBOX_TAG_FRAMEBUFFER_RELEASE =                    0x00048001,
  MBOX_TAG_FRAMEBUFFER_TEST_PHYSICAL_WIDTH_HEIGHT = 0x00044003,
  MBOX_TAG_FRAMEBUFFER_TEST_VIRTUAL_WIDTH_HEIGHT =  0x00044004,
  MBOX_TAG_FRAMEBUFFER_TEST_DEPTH =                 0x00044005,
  MBOX_TAG_FRAMEBUFFER_TEST_PIXEL_ORDER =           0x00044006,
  MBOX_TAG_FRAMEBUFFER_TEST_ALPHA_MODE =            0x00044007,
  MBOX_TAG_FRAMEBUFFER_TEST_VIRTUAL_OFFSET =        0x00044009,
  MBOX_TAG_FRAMEBUFFER_TEST_OVERSCAN =              0x0004400a,
  MBOX_TAG_FRAMEBUFFER_TEST_PALETTE =               0x0004400b,
  MBOX_TAG_FRAMEBUFFER_TEST_VSYNC =                 0x0004400e,
  MBOX_TAG_FRAMEBUFFER_SET_PHYSICAL_WIDTH_HEIGHT =  0x00048003,
  MBOX_TAG_FRAMEBUFFER_SET_VIRTUAL_WIDTH_HEIGHT =   0x00048004,
  MBOX_TAG_FRAMEBUFFER_SET_DEPTH =                  0x00048005,
  MBOX_TAG_FRAMEBUFFER_SET_PIXEL_ORDER =            0x00048006,
  MBOX_TAG_FRAMEBUFFER_SET_ALPHA_MODE =             0x00048007,
  MBOX_TAG_FRAMEBUFFER_SET_VIRTUAL_OFFSET =         0x00048009,
  MBOX_TAG_FRAMEBUFFER_SET_OVERSCAN =               0x0004800a,
  MBOX_TAG_FRAMEBUFFER_SET_PALETTE =                0x0004800b,
  MBOX_TAG_FRAMEBUFFER_SET_TOUCHBUF =               0x0004801f,
  MBOX_TAG_FRAMEBUFFER_SET_GPIOVIRTBUF =            0x00048020,
  MBOX_TAG_FRAMEBUFFER_SET_VSYNC =                  0x0004800e,
  MBOX_TAG_FRAMEBUFFER_SET_BACKLIGHT =              0x0004800f
} typedef mailboxTagE;

struct mailboxTagS {
  u32 id;
  u32 buffer_size;
  u32 value_length;
} typedef mailboxTagS;

struct mailboxClockS {
  mailboxTagS tag;
  u32 id;
  u32 rate;
} typedef mailboxClockS;

typedef enum {
  CT_EMMC = 1,
  CT_UART = 2,
  CT_ARM = 3,
  CT_CORE = 4
} clockTypeE;

void mailbox_process(mailboxTagS *tag, u32 tag_data_size);
u32 mailbox_clock_rate(clockTypeE ct);

#endif /* _MAILBOX_H */